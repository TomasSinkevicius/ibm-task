{"ast":null,"code":"import _regeneratorRuntime from \"/Users/tomas/Documents/Github/IBM/ibm-task/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/tomas/Documents/Github/IBM/ibm-task/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/tomas/Documents/Github/IBM/ibm-task/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/Users/tomas/Documents/Github/IBM/ibm-task/src/components/company-profiles/company-profiles.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport * as Styled from './styles';\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { StockCandles } from '../stock-candles/stock-candles';\nimport { CompanyProfileTiles } from './company-profile-tiles/company-profile-tiles';\nimport { convertToHumanDateFormat } from '../utils/convert-date';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport var CompanyProfiles = function CompanyProfiles(_ref) {\n  _s();\n\n  var companyProfileValues = _ref.companyProfileValues,\n      count = _ref.count,\n      getCompanyProfiles = _ref.getCompanyProfiles,\n      searchValue = _ref.searchValue,\n      setErrors = _ref.setErrors,\n      symbols = _ref.symbols,\n      index = _ref.index,\n      setIndex = _ref.setIndex;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      stockCandles = _useState2[0],\n      setStockCandles = _useState2[1];\n\n  var INTERVAL_OPTIONS = [1, 5, 15, 30, 60, 'D', 'W', 'M'];\n\n  var _useState3 = useState(INTERVAL_OPTIONS[0]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      interval = _useState4[0],\n      setInterval = _useState4[1];\n\n  var _useState5 = useState({\n    symbol: '',\n    name: ''\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      selectedCompany = _useState6[0],\n      setSelectedCompany = _useState6[1];\n\n  var getStockCandles = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(selectedCompany) {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                var FINNGUB_STOCK_CANDLES_API = \"\".concat(process.env.REACT_APP_FINNHUB_STOCK_CANDLES_API, \"?symbol=\").concat(selectedCompany, \"&resolution=\").concat(interval, \"&from=\").concat(searchValue.dateFrom, \"&to=\").concat(searchValue.dateTo, \"&token=\").concat(process.env.REACT_APP_FINNHUB_TOKEN);\n                console.log('LINK', FINNGUB_STOCK_CANDLES_API);\n                axios.get(FINNGUB_STOCK_CANDLES_API).then(function (response) {\n                  resolve(response.data);\n                })[\"catch\"](function (err) {\n                  return reject(err);\n                });\n              }));\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getStockCandles(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleStockCandles = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(symbol, companyName) {\n      var responseCandles;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return getStockCandles(symbol);\n\n            case 3:\n              responseCandles = _context2.sent;\n              setStockCandles(responseCandles);\n              setSelectedCompany({\n                symbol: symbol,\n                name: companyName\n              });\n              setIndex(1);\n              sendClientData(companyName, responseCandles);\n              _context2.next = 14;\n              break;\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n\n              if (_context2.t0.response.status === 403) {\n                sendClientData(companyName, 'NO-ACCESS');\n                alert('no access');\n              }\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 10]]);\n    }));\n\n    return function handleStockCandles(_x2, _x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var sendClientData = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(companyName, responseCandles) {\n      var SERVER_API, body;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              SERVER_API = \"\".concat(process.env.REACT_APP_SERVER_API, \"/action\");\n              body = {\n                companyName: companyName,\n                dateFrom: convertToHumanDateFormat(searchValue.dateFrom),\n                dateTo: convertToHumanDateFormat(searchValue.dateTo),\n                stockPriceHistory: responseCandles\n              };\n              axios.post(SERVER_API, body).then(function (response) {\n                console.log(response.data);\n              })[\"catch\"](function (err) {\n                return console.log(err);\n              });\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function sendClientData(_x4, _x5) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    handleStockCandles();\n  }, [interval]);\n  return /*#__PURE__*/_jsxDEV(Styled.Section, {\n    children: index === 1 ? /*#__PURE__*/_jsxDEV(StockCandles, {\n      setIndex: setIndex,\n      stockCandles: stockCandles,\n      setInterval: setInterval,\n      INTERVAL_OPTIONS: INTERVAL_OPTIONS,\n      selectedCompany: selectedCompany\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, _this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(CompanyProfileTiles, {\n        companyProfileValues: companyProfileValues,\n        handleStockCandles: handleStockCandles,\n        searchValue: searchValue,\n        setErrors: setErrors\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, _this), companyProfileValues.length < count && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        onClick: function onClick() {\n          getCompanyProfiles(symbols, companyProfileValues.length + 1, companyProfileValues.length + 5);\n        },\n        children: \"Get more\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, _this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(CompanyProfiles, \"GhWvXf8E8kMhT9/A0Qz+DOEdFUA=\");\n\n_c = CompanyProfiles;\n\nvar _c;\n\n$RefreshReg$(_c, \"CompanyProfiles\");","map":{"version":3,"names":["Styled","React","useState","useEffect","axios","StockCandles","CompanyProfileTiles","convertToHumanDateFormat","CompanyProfiles","companyProfileValues","count","getCompanyProfiles","searchValue","setErrors","symbols","index","setIndex","stockCandles","setStockCandles","INTERVAL_OPTIONS","interval","setInterval","symbol","name","selectedCompany","setSelectedCompany","getStockCandles","Promise","resolve","reject","FINNGUB_STOCK_CANDLES_API","process","env","REACT_APP_FINNHUB_STOCK_CANDLES_API","dateFrom","dateTo","REACT_APP_FINNHUB_TOKEN","console","log","get","then","response","data","err","handleStockCandles","companyName","responseCandles","sendClientData","status","alert","SERVER_API","REACT_APP_SERVER_API","body","stockPriceHistory","post","length"],"sources":["/Users/tomas/Documents/Github/IBM/ibm-task/src/components/company-profiles/company-profiles.jsx"],"sourcesContent":["import * as Styled from './styles'\nimport React, { useState, useEffect } from 'react'\nimport axios from 'axios'\nimport { StockCandles } from '../stock-candles/stock-candles'\nimport { CompanyProfileTiles } from './company-profile-tiles/company-profile-tiles'\nimport { convertToHumanDateFormat } from '../utils/convert-date'\n\nexport const CompanyProfiles = ({\n  companyProfileValues,\n  count,\n  getCompanyProfiles,\n  searchValue,\n  setErrors,\n  symbols,\n  index,\n  setIndex,\n}) => {\n  const [stockCandles, setStockCandles] = useState({})\n\n  const INTERVAL_OPTIONS = [1, 5, 15, 30, 60, 'D', 'W', 'M']\n  const [interval, setInterval] = useState(INTERVAL_OPTIONS[0])\n  const [selectedCompany, setSelectedCompany] = useState({ symbol: '', name: '' })\n\n  const getStockCandles = async selectedCompany => {\n    return new Promise((resolve, reject) => {\n      const FINNGUB_STOCK_CANDLES_API = `${process.env.REACT_APP_FINNHUB_STOCK_CANDLES_API}?symbol=${selectedCompany}&resolution=${interval}&from=${searchValue.dateFrom}&to=${searchValue.dateTo}&token=${process.env.REACT_APP_FINNHUB_TOKEN}`\n      console.log('LINK', FINNGUB_STOCK_CANDLES_API)\n\n      axios\n        .get(FINNGUB_STOCK_CANDLES_API)\n        .then(response => {\n          resolve(response.data)\n        })\n        .catch(err => reject(err))\n    })\n  }\n\n  const handleStockCandles = async (symbol, companyName) => {\n    try {\n      const responseCandles = await getStockCandles(symbol)\n      setStockCandles(responseCandles)\n      setSelectedCompany({ symbol: symbol, name: companyName })\n      setIndex(1)\n      sendClientData(companyName, responseCandles)\n    } catch (error) {\n      console.log(error)\n      if (error.response.status === 403) {\n        sendClientData(companyName, 'NO-ACCESS')\n        alert('no access')\n      }\n    }\n  }\n\n  const sendClientData = async (companyName, responseCandles) => {\n    const SERVER_API = `${process.env.REACT_APP_SERVER_API}/action`\n    const body = {\n      companyName: companyName,\n      dateFrom: convertToHumanDateFormat(searchValue.dateFrom),\n      dateTo: convertToHumanDateFormat(searchValue.dateTo),\n      stockPriceHistory: responseCandles,\n    }\n\n    axios\n      .post(SERVER_API, body)\n      .then(response => {\n        console.log(response.data)\n      })\n      .catch(err => console.log(err))\n  }\n\n  useEffect(() => {\n    handleStockCandles()\n  }, [interval])\n\n  return (\n    <Styled.Section>\n      {index === 1 ? (\n        <StockCandles\n          setIndex={setIndex}\n          stockCandles={stockCandles}\n          setInterval={setInterval}\n          INTERVAL_OPTIONS={INTERVAL_OPTIONS}\n          selectedCompany={selectedCompany}\n        />\n      ) : (\n        <>\n          <CompanyProfileTiles\n            companyProfileValues={companyProfileValues}\n            handleStockCandles={handleStockCandles}\n            searchValue={searchValue}\n            setErrors={setErrors}\n          />\n          {companyProfileValues.length < count && (\n            <button\n              className='btn btn-primary'\n              onClick={() => {\n                getCompanyProfiles(\n                  symbols,\n                  companyProfileValues.length + 1,\n                  companyProfileValues.length + 5,\n                )\n              }}\n            >\n              Get more\n            </button>\n          )}\n        </>\n      )}\n    </Styled.Section>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}